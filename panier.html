<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Panier - Imprixo</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="/"><h1>ðŸŽ¨ <span class="brand">Imprixo</span></h1></a>
                </div>
                <nav class="nav">
                    <a href="/">Accueil</a>
                    <a href="/catalogue.html">Catalogue</a>
                </nav>
                <div class="header-actions">
                    <a href="/panier.html" class="btn-cart active">ðŸ›’ Panier <span class="cart-count" id="cartCount">0</span></a>
                </div>
            </div>
        </div>
    </header>

    <section style="padding: 60px 0;">
        <div class="container">
            <h1 style="font-size: 42px; margin-bottom: 40px;">Mon Panier</h1>

            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 40px;">
                <!-- Liste articles -->
                <div>
                    <div id="cartItems" style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <!-- Rempli par JS -->
                    </div>
                </div>

                <!-- RÃ©capitulatif -->
                <div>
                    <div style="background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); position: sticky; top: 100px;">
                        <h3 style="margin-bottom: 20px;">RÃ©capitulatif</h3>

                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #e0e0e0;">
                            <span>Sous-total</span>
                            <span id="subtotal" style="font-weight: 600;">0,00 â‚¬</span>
                        </div>

                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #e0e0e0;">
                            <span>TVA (20%)</span>
                            <span id="tva" style="font-weight: 600;">0,00 â‚¬</span>
                        </div>

                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #e0e0e0;">
                            <span>Livraison</span>
                            <span id="shipping" style="font-weight: 600;">Gratuite</span>
                        </div>

                        <div style="display: flex; justify-content: space-between; margin-top: 20px; font-size: 20px; font-weight: 700;">
                            <span>TOTAL TTC</span>
                            <span id="total" style="color: #667eea;">0,00 â‚¬</span>
                        </div>

                        <a href="/checkout.html" id="checkoutBtn" class="btn btn-primary" style="width: 100%; margin-top: 30px; padding: 16px; text-align: center; font-size: 18px;">
                            Valider la commande
                        </a>

                        <a href="/catalogue.html" class="btn btn-outline" style="width: 100%; margin-top: 15px; padding: 12px; text-align: center;">
                            Continuer mes achats
                        </a>

                        <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; font-size: 14px; color: #666;">
                            <strong>ðŸš€ Livraison express 48-72h</strong><br>
                            âœ“ Paiement sÃ©curisÃ© Stripe<br>
                            âœ“ Production sous 24-48h<br>
                            âœ“ QualitÃ© garantie
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="/js/app.js"></script>
    <script>
        function displayCart() {
            const items = Imprixo.cart.items;
            const container = document.getElementById('cartItems');

            if (items.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px;">
                        <div style="font-size: 64px; margin-bottom: 20px;">ðŸ›’</div>
                        <h3 style="margin-bottom: 10px;">Votre panier est vide</h3>
                        <p style="color: #666; margin-bottom: 30px;">Ajoutez des produits pour commencer</p>
                        <a href="/catalogue.html" class="btn btn-primary">Voir le catalogue</a>
                    </div>
                `;
                updateTotals(0);
                return;
            }

            container.innerHTML = items.map(item => `
                <div style="display: flex; gap: 20px; padding: 20px; border-bottom: 1px solid #e0e0e0;">
                    <div style="flex: 1;">
                        <h4 style="margin-bottom: 5px;">${item.nom}</h4>
                        <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                            ${item.surface.toFixed(2)} mÂ² (${item.config.largeur}Ã—${item.config.hauteur}cm)<br>
                            ${item.config.impression === 'double' ? 'Double face' : 'Simple face'}
                            ${item.config.oeillets ? ' â€¢ Å’illets' : ''}
                            ${item.config.decoupe ? ' â€¢ DÃ©coupe' : ''}
                            ${item.config.lamination ? ' â€¢ Lamination' : ''}
                        </p>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                QuantitÃ©:
                                <input type="number" value="${item.quantite}" min="1"
                                    onchange="Imprixo.cart.update(${item.id}, parseInt(this.value)); displayCart();"
                                    style="width: 80px; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px;">
                            </label>
                            <button onclick="Imprixo.cart.remove(${item.id}); displayCart();"
                                style="color: #e74c3c; background: none; border: none; cursor: pointer; text-decoration: underline;">
                                Supprimer
                            </button>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; color: #666; margin-bottom: 5px;">
                            ${Imprixo.formatPrice(item.prix)} Ã— ${item.quantite}
                        </div>
                        <div style="font-size: 20px; font-weight: 700; color: #667eea;">
                            ${Imprixo.formatPrice(item.prix * item.quantite)}
                        </div>
                    </div>
                </div>
            `).join('');

            const subtotal = Imprixo.cart.getTotal();
            updateTotals(subtotal);
        }

        function updateTotals(subtotal) {
            const ht = subtotal / 1.2;
            const tva = subtotal - ht;

            document.getElementById('subtotal').textContent = Imprixo.formatPrice(ht);
            document.getElementById('tva').textContent = Imprixo.formatPrice(tva);
            document.getElementById('total').textContent = Imprixo.formatPrice(subtotal);

            const checkoutBtn = document.getElementById('checkoutBtn');
            if (subtotal === 0) {
                checkoutBtn.style.opacity = '0.5';
                checkoutBtn.style.pointerEvents = 'none';
            } else {
                checkoutBtn.style.opacity = '1';
                checkoutBtn.style.pointerEvents = 'auto';
            }
        }

        displayCart();
    </script>
</body>
</html>
